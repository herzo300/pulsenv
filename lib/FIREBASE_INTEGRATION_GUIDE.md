# üìã Firebase Push Notifications - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

## üéØ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ

### 1. Backend ‚úÖ
- ‚úÖ Firebase –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ pubspec.yaml
- ‚úÖ Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ main.dart
- ‚úÖ Notification Service —Å–æ–∑–¥–∞–Ω –∏ —É–ø—Ä–æ—â–µ–Ω

### 2. –§—Ä–æ–Ω—Ç–µ–Ω–¥ ‚úÖ
- ‚úÖ Firebase –ø–æ–¥–∫–ª—é—á–µ–Ω
- ‚úÖ –ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ –£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –°—Å—ã–ª–∫–∏ –Ω–∞ –ø–æ–ª–∏—Ç–∏–∫—É –∏ —É—Å–ª–æ–≤–∏—è –¥–æ–±–∞–≤–ª–µ–Ω—ã

### 3. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ‚úÖ
- ‚úÖ 3 —Ñ–∞–π–ª–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
- ‚úÖ 100+ —Ñ—É–Ω–∫—Ü–∏–π –æ–ø–∏—Å–∞–Ω—ã

---

## üîß –ß—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã Push Notifications

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å Firebase –ø—Ä–æ–µ–∫—Ç

1. **–í–æ–π–¥–∏—Ç–µ –≤ Firebase Console:**
   - https://console.firebase.google.com
   - –ù–∞–∂–º–∏—Ç–µ "Add project"

2. **–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø—Ä–æ–µ–∫—Ç–∞:**
   - "Android" ‚Üí Flutter
   - "iOS" ‚Üí Flutter
   - "Web" ‚Üí Flutter Web

3. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:**
   - `soobshio-nizhnevartovsk`

4. **–ù–∞–∂–º–∏—Ç–µ "Create app"**

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

1. **–î–æ–±–∞–≤—å—Ç–µ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   - –í –º–µ–Ω—é —Å–ª–µ–≤–∞ –≤—ã–±–µ—Ä–∏—Ç–µ "soobshio-nizhnevartovsk"

2. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ google-services.json:**
   - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
   - –ö–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª "google-services.json"
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤: `C:\Soobshio_project\android\app\google-services.json`

3. **–ó–∞–º–µ–Ω–∏—Ç–µ –≤ firebase_options.dart:**
   ```yaml
   web:
     apiKey: "–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_API_–ö–õ–Æ–ß"
     appId: "–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_APP_ID"
     messagingSenderId: "–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_SENDER_ID"
     projectId: "soobshio-nizhnevartovsk"
   
   android:
     apiKey: "–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_API_–ö–õ–Æ–ß"
     appId: "–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_ANDROID_APP_ID"
     messagingSenderId: "–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_SENDER_ID"
     projectId: "soobshio-nizhnevartovsk"
   
   ios:
     apiKey: "–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_API_–õ–Æ–ß"
     appId: "–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_IOS_APP_ID"
     messagingSenderId: "–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_SENDER_ID"
     projectId: "soobshio-nizhnevartovsk"
     iosBundleId: "com.soobshio.app"
   ```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

1. **–î–æ–±–∞–≤—å—Ç–µ iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   - –í –º–µ–Ω—é —Å–ª–µ–≤–∞ –≤—ã–±–µ—Ä–∏—Ç–µ "soobshio-nizhnevartovsk"

2. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ GoogleService-Info.plist:**
   - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
   - –ö–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª "GoogleService-Info.plist"
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤: `C:\Soobshio_project\ios\Runner\GoogleService-Info.plist`

3. **–û–±–Ω–æ–≤–∏—Ç–µ Info.plist:**
   ```xml
   <key>UIBackgroundModes</key>
   <array>
     <string>fetch</string>
     <string>remote-notification</string>
   </array>
   ```

### –®–∞–≥ 4: –ü–æ–ª—É—á–∏—Ç–µ Server Key

1. **–í Firebase Console:**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ: Project Settings ‚Üí Service Accounts
   - –í—ã–±–µ—Ä–∏—Ç–µ: Service Account ‚Üí Generate New Private Key
   - –¢–∏–ø: "Server Key"
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á
   - –§–æ—Ä–º–∞—Ç: `x1234567890abcdef...`

2. **–î–æ–±–∞–≤—å—Ç–µ Server Key –≤ firebase_options.dart:**
   ```yaml
   web:
     apiKey: "–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_SERVER_–ö–õ–Æ–ß"
   
   android:
     apiKey: "–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_SERVER_–ö–õ–Æ–ß"
   
   ios:
     apiKey: "–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_SERVER_–ö–õ–Æ–ß"
   ```

---

## üì± –§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### 1. Backend:
```
C:\Soobshio_project\
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ main.dart                     –û–±–Ω–æ–≤–∏—Ç—å —Å Firebase
‚îÇ   ‚îî‚îÄ‚îÄ lib/
‚îÇ       ‚îî‚îÄ‚îÄ firebase_options.dart      –ó–∞–º–µ–Ω–∏—Ç—å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã
‚îÇ       ‚îî‚îÄ‚îÄ PRIVACY_POLICY.md       –ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
‚îÇ       ‚îî‚îÄ‚îÄ TERMS_OF_SERVICE.md     –£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ INTEGRATION_COMPLETE.md    –≠—Ç–æ—Ç –æ—Ç—á–µ—Ç
‚îÇ
‚îî‚îÄ‚îÄ android/
    ‚îî‚îÄ‚îÄ app/
        ‚îî‚îÄ‚îÄ google-services.json      –°–æ–∑–¥–∞—Ç—å —Å Firebase Console
```

### 2. Backend:
```
C:\Soobshio_project\
‚îî‚îÄ‚îÄ android/
    ‚îî‚îÄ‚îÄ app/
        ‚îî‚îÄ‚îÄ google-services.json      –°–æ–∑–¥–∞—Ç—å —Å Firebase Console
```

### 3. Backend:
```
C:\Soobshio_project\
‚îî‚îÄ‚îÄ ios/
    ‚îî‚îÄ‚îÄ Runner/
        ‚îî‚îÄ‚îÄ GoogleService-Info.plist  –°–æ–∑–¥–∞—Ç—å —Å Firebase Console
```

---

## üîë –ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π main.dart
```dart
void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  await Firebase.initializeApp();
  runApp(const PulsGorodaApp());
}
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π firebase_options.dart
```dart
static const FirebaseOptions web = FirebaseOptions(
  apiKey: '–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_API_–ö–õ–Æ–ß',
  appId: '–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_APP_ID',
  messagingSenderId: '–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_SENDER_ID',
  projectId: 'soobshio-nizhnevartovsk',
  // ...
);
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Firebase
   - –¢–µ—Å—Ç–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –±—É–¥—É—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω—ã–µ
   - –ù–∞—Å—Ç–æ—è—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Firebase

2. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
   - Firebase –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω (Spark) –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ 10k —É—Å—Ç—Ä–æ–π—Å—Ç–≤
   - –ü–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω (Blaze) –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ 300k —É—Å—Ç—Ä–æ–π—Å—Ç–≤
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å

3. **–û—Ç–ª–∞–¥–∫–∞:**
   - –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `flutter run --verbose`
   - –í–∫–ª—é—á–∏—Ç–µ —Ä–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ Firebase –≤ Console
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

---

## üìö –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Firebase

### –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Firebase:

1. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É FCM —Ç–æ–∫–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä**
   ```dart
   // –í NotificationService._saveTokenToServer()
   final response = await http.post(
     Uri.parse('http://127.0.0.1:8000/api/fcm-token'),
     headers: {'Content-Type': 'application/json'},
     body: jsonEncode({'token': token}),
   );
   ```

2. **–°–æ–∑–¥–∞—Ç—å API endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤**
   ```python
   @app.post('/api/fcm-token')
   async def save_fcm_token(request: Request):
       token = request.json.get('token')
       # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
       # –ü–æ–¥–ø–∏—Å–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Ç–µ–º—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
       pass
   ```

3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
   ```python
   # –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   from firebase_admin import messaging
   messaging = messaging.Client('path/to/service-account-key.json')
   message = messaging.Message(
     notification=messaging.Notification(
       title='–¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ',
       body='–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç –°–æ–æ–±—â–∏–û',
       token='–í–ê–®_FCM_–¢–û–ö–ï–ù_–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø',
     ),
   topic='test-topic'
   )
   messaging.send(message)
   ```

---

## üìû –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –Ω–∞—Å—Ç–æ—è—â–∏–µ Firebase –∫–ª—é—á–∏ –≤ –∫–æ–¥
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
- –ù–µ –∫–æ–º–º–∏—Ç—Ç–µ —Ñ–∞–π–ª—ã —Å –∫–ª—é—á–∞–º–∏ –≤ Git

### 2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Firebase Admin SDK –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫
- –ö—ç—à–∏—Ä—É–π—Ç–µ FCM —Ç–æ–∫–µ–Ω—ã
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ–º—ã –¥–ª—è —Ç–∞—Ä–≥–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### 3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Firebase Console
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π FCM —Ç–æ–∫–µ–Ω
- –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

---

## üìã –ü–æ–ª–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç

### Backend:
- [x] Pubspec.yaml –æ–±–Ω–æ–≤–ª–µ–Ω
- [x] Firebase Core –ø–æ–¥–∫–ª—é—á–µ–Ω –≤ main.dart
- [x] Notification Service —Å–æ–∑–¥–∞–Ω
- [x] –ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–Ω–∞
- [x] –£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–æ–∑–¥–∞–Ω—ã
- [x] –°—Å—ã–ª–∫–∏ –Ω–∞ –ø–æ–ª–∏—Ç–∏–∫—É –∏ —É—Å–ª–æ–≤–∏—è –¥–æ–±–∞–≤–ª–µ–Ω—ã

### Frontend:
- [x] Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- [x] –ö–Ω–æ–ø–∫–∏ –¥–ª—è Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- [x] –ö–Ω–æ–ø–∫–∏ –Ω–∞ –ø–æ–ª–∏—Ç–∏–∫—É/—É—Å–ª–æ–≤–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç
- [x] –ü—É–ª—å—Å –ì–æ—Ä–æ–¥–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω

### Firebase:
- [x] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã
- [x] –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- [x] –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Å–æ–∑–¥–∞–Ω–æ

---

**–î–∞—Ç–∞:** 9 —Ñ–µ–≤—Ä–∞–ª—è 2026 –≥.
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞, —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Firebase
